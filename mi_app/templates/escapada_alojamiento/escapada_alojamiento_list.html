{% extends 'base.html' %}
{% load static %}

{% block title %}
  Escapadas y Alojamientos - Gestión de Escapadas
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6 bg-white shadow rounded-lg">
  <h2 class="text-2xl font-bold mb-4">Escapadas y Alojamientos</h2>
  <p class="text-gray-700 mb-4">Aquí se listan todas las Escapadas con sus Alojamientos asociados.</p>

  {% for e in escapadas %}
    <div class="mb-6 p-4 border border-gray-200 rounded">
      <h3 class="text-xl font-semibold">{{ e.nombre }}</h3>
      <p class="text-sm text-gray-600">
        <strong>Lugar:</strong> {{ e.lugar }} | 
        <strong>Fechas:</strong> {{ e.fecha_ini }} - {{ e.fecha_fin }} |
        <strong>Estado:</strong> {{ e.estado }}
      </p>

      {% if e.escapadas_alojamiento.exists %}
        <!-- Mostramos cada asociación EscapadaAlojamiento que contiene Alojamientos -->
        <ul class="mt-3 list-disc list-inside">
          {% for rel in e.escapadas_alojamiento.all %}
            <li>
              <strong>{{ rel.alojamiento.nombre }}</strong> 
              ({{ rel.alojamiento.get_tipo_alojamiento_display }})  
              - {{ rel.alojamiento.direccion }}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="italic text-gray-600 mt-2">No hay alojamientos asociados a esta escapada.</p>
      {% endif %}
    </div>
  {% empty %}
    <p class="text-gray-600">No hay escapadas registradas.</p>
  {% endfor %}
</div>
{% endblock %}
